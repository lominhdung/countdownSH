<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Surgery Tracker</title>
    <style>
        body { font-family: sans-serif; background: #01080e; color: white; display: flex; justify-content: center; padding: 20px; }
        .card { background: #0a1622; padding: 25px; border-radius: 15px; width: 100%; max-width: 350px; border: 1px solid #00ff7f; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #1a2a3a; background: #01080e; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; background: #00ff7f; color: #000; margin-top: 10px; }
        label { font-size: 12px; color: #00ff7f; text-transform: uppercase; }
    </style>
</head>
<body>
    <div class="card">
        <h3>COMMAND_CENTER</h3>
        <label>Mật mã bảo mật</label>
        <input type="password" id="pin" placeholder="****">
        <hr style="opacity: 0.1; margin: 20px 0;">
        <label>Thiết lập mục tiêu</label>
        <input type="number" id="targetVal" placeholder="Ví dụ: 5000">
        <button onclick="updateData('target', 'targetVal')">CẬP NHẬT MỤC TIÊU</button>
        <br><br>
        <label>Số ca hiện tại</label>
        <input type="number" id="totalVal" placeholder="Ví dụ: 1200">
        <button onclick="updateData('total', 'totalVal')" style="background: #ffce67;">CẬP NHẬT SỐ LIỆU</button>
        <p id="msg" style="text-align: center; font-size: 12px; margin-top: 15px;"></p>
    </div>

    <script>
        const FIREBASE_URL = "https://cdsh-a2c06-default-rtdb.asia-southeast1.firebasedatabase.app/.json";
        const PIN_CODE = "1234"; // Thay đổi mã PIN ở đây

        async function updateData(key, inputId) {
            const val = document.getElementById(inputId).value;
            const pin = document.getElementById("pin").value;
            const msg = document.getElementById("msg");

            if(pin !== PIN_CODE) return alert("Sai mã bảo mật!");
            if(!val) return alert("Vui lòng nhập số!");

            msg.innerText = "Đang đồng bộ...";
            const data = {}; data[key] = Number(val);

            try {
                await fetch(FIREBASE_URL, { method: 'PATCH', body: JSON.stringify(data) });
                msg.innerText = "Đã cập nhật thành công! ✅";
                setTimeout(() => msg.innerText = "", 2000);
            } catch(e) {
                msg.innerText = "Lỗi kết nối mạng! ❌";
            }
        }
    </script>
</body>
</html>
